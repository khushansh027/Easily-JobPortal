<div class="card-body">
    <h1 class="text-center text-success">
        <span class="text-danger"> <%= job.position %> </span> opportunity in <%= job.location %> at
        <span class="text-info"> <%= job.company %> </span>
    </h1>
    <div class="container d-flex flex-column justify-content-start my-3">
        <h5 class="my-1"><%= job.company %></h5>
        <div style="font-size: large;">
                <span> - Tech</span>
                <span class="text-success"><%= job.position %></span>
        </div>
        <div class="d-flex flex-column justify-content-start p-3">
            <span>
                <% if (recruiterEmail) { %>
                    <a href="/jobs/<%= job.id %>/edit" class="btn btn-warning">Edit</a>
                    <a href="/jobs/<%= job.id %>/delete" class="btn btn-danger" onclick="return confirmDeletion()">Delete</a>

                <% } %>
            </span>
            <span class="">
                <i class="fa fa-map-marker"></i>
                <%= job.location %>
            </span>
            <span class="">
                <i class="fa fa-rupee"></i>
                <%= job.salary %>
            </span>
            <span>
                <i class="fa fa-calendar-o"></i>
                Apply By <%= job.applyBy %>
            </span>
            <span>
                <i class="fa fa-bullhorn"></i>
                Openings: <%= job.openings %>
            </span>
            <a style="text-decoration: none; color: rgb(215, 20, 85)" href="applicants/<%= job.id %>">
                <span>
                    <i class="fa fa-users"></i>
                    Applicants: <%= job.applicants.length %> <!-- Show the number of applicants -->
                </span>
            </a>
        </div>

        <!-- Skills Section -->
        <div class="container pl-3">
            <div class="skills">
                <% job.skills.forEach(skill => { %>
                    <button class="btn btn-sm btn-outline-info mb-1"><%= skill %></button>
                <% }) %>
            </div>

            <!-- Apply Now Button -->
            <% if (!recruiterEmail) { %>
                <!-- Job Seeker View: only show the applicant count -->
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#applyModal">
                    Apply Now
                </button>
            <% } else { %>
                <!-- Recruiter View: show count and allow viewing applicants -->
                <button id="viewApplicantsBtn">View Applicants</button>
            <% } %>

            <!-- Apply Now Modal -->
            <div class="modal fade" id="applyModal" tabindex="-1" aria-labelledby="applyModalLabel" role="dialog" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h1 class="modal-title fw-light text-success fs-5" id="applyModalLabel">easily</h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body fw-normal fs-6" style="color: black;">
                            <h2 class="fw-semibold text-center pb-2" style="color: blueviolet; text-decoration: double;">Apply in less than 1 minute !!</h2>
                            <form id="applyForm" action="/jobs/<%= job.id %>/apply" method="POST" enctype="multipart/form-data">
                                <input type="hidden" class="form-control" id="id" name="id" value="1">
                                <div class="mb-3">
                                    <label for="name" class="form-label">Name</label>
                                    <input type="text" class="form-control fw-light" id="name" name="name" placeholder="test">
                                </div>
                                <div class="mb-3">
                                    <label for="email" class="form-label">Email</label>
                                    <input type="email" class="form-control fw-light" id="email" name="email" step="0.01" placeholder="test@gmail.com">
                                </div>
                                <div class="mb-3">
                                    <label for="contact" class="form-label">Contact</label>
                                    <input type="tel" class="form-control fw-light" id="contact" name="contact" step="0.01" placeholder="+91 1234567890">
                                </div>
                                <div class="mb-3">
                                    <label for="resume" class="form-label">Resume</label>
                                    <input type="file" class="form-control fw-light" id="resume" name="resume" accept=".pdf">
                                </div>
                                <div class="text-center">
                                    <button type="submit" class="btn btn-primary fw-light">Submit</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div> <!-- Close Modal -->
        </div> <!-- Close skills container -->
    </div> <!-- Close main container -->

    <!-- Job Posting Date -->
    <small class="text-body-secondary" style="padding-left: 25px; padding-top: 20px">
        <span 
            style="width: 160px" 
            class="bg-success text-white border border-success border border-success p-1 border-opacity-50 rounded">
            Posted: <%= job.postedAt %>
        </span>
    </small>
</div>
<script>
    // Function to show a confirmation popup before deletion
    function confirmDeletion() {
        return confirm("Are you sure you want to delete this job?");
        
    }
</script>